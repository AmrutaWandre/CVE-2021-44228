<?xml version="1.0" encoding="utf-8"?>
<OpenIOC xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="45c3e506-71bb-49eb-9157-efb81904d880" last-modified="2021-12-13T22:31:54Z" published-date="0001-01-01T00:00:00" xmlns="http://openioc.org/schemas/OpenIOC_1.1">
  <metadata>
    <short_description>SUSPICIOUS PROCESS LAUNCH FROM JAVA (METHODOLOGY)</short_description>
    <description>This IOC looks for suspicious commands from Java applications on Windows systems, and may provide an indicator of exploitation of a Remote Code Execution vulnerability such as CVE-2021-44228 (Apache Log4j 2), or the presence of a webshell on a Java-based web server. Note that cmd launched by Java without any command line parameters may be indicative of an evasion technique in which commands are piped to cmd. Investigate the source of activity and the processes launched to confirm maliciousness. This is associated with MITRE ATT&amp;CK (r) Tactic(s): Initial Access, Persistence, Defense Evasion and Technique(s): T1190, T1505.003, T1027.005.</description>
    <authored_by>FireEye</authored_by>
    <authored_date>2021-12-13T00:59:43Z</authored_date>
    <links>
      <link href="" rel="caveat">Methodology</link>
    </links>
  </metadata>
  <criteria>
    <Indicator operator="OR" id="581cda53-9d80-4ce9-b61f-b5951b400c52">
      <Indicator operator="AND" id="587a3626-a3b0-4766-b17c-050edd14579a">
        <IndicatorItem id="4a27fbb0-1b4a-4f76-afd4-528943c0f233" condition="starts-with" preserve-case="false" negate="false">
          <Context document="processEvent" search="processEvent/parentProcess" type="event" />
          <Content type="string">java</Content>
        </IndicatorItem>
        <IndicatorItem id="b7fa13c5-0235-4538-b67c-cb49ef6787fd" condition="is" preserve-case="false" negate="false">
          <Context document="processEvent" search="processEvent/eventType" type="event" />
          <Content type="string">start</Content>
        </IndicatorItem>
        <Indicator operator="OR" id="ca6b317c-e184-4549-ba80-cd74996ffd35">
          <IndicatorItem id="b26686fa-fac1-40d7-9cf9-d9e9e38875bf" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">cmd.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="ea847962-2b5a-4b40-9315-e3bbe3a81ad9" condition="matches" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">^cmd(\.exe)?\s+/c\s</Content>
          </IndicatorItem>
          <IndicatorItem id="f0120b47-ef9f-46cf-8fe5-28665ae31615" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">AppInstaller.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="8913bc6d-a8e8-4809-97df-6a2dc3a15a23" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Bitsadmin.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="d1520559-43ef-45a5-a18c-288d0b88abd7" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">CertOC.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="e6029205-db66-455d-95c8-81e5cda7e22a" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">CertReq.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="61793c17-5436-469c-8587-cea2907aede1" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">cmdl32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="91eb6669-37f4-48d5-b65e-546a8d2ed121" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Control.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f7b0ed48-846e-411c-9fe5-db60951f334b" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Cscript.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="c49e78ed-f07e-4707-b17e-e7ce28be5b97" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Desktopimgdownldr.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="71b128f9-f6d9-4ffa-b487-1862abb8b80f" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Diantz.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="34ad5ebb-504b-4fd5-910a-687e1621a092" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Esentutl.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="6fe1d034-c25c-49aa-9728-744519ab3152" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Eventvwr.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="63d1cf7b-db80-4a19-805e-6f30395d6f37" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Expand.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="76d29b24-936f-4122-8cbd-3d1ef86fc1bc" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Extrac32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="fc6f1e0a-bf1b-4af8-993c-a70162e5edf9" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Findstr.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="51c8b81d-5066-4c70-9940-433acbd8185c" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Finger.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="126125ea-060a-457a-975a-4e9f6b6b74a1" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Ftp.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="4c0a3fae-dc9a-4475-be43-8231855a3630" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">GfxDownloadWrapper.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="a5a1f7e0-4986-48d0-ae26-55e5362186fc" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Hh.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="8bf0d685-b6bd-48e2-9459-ead223983bd0" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">IMEWDBLD.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="6201dc57-5132-4425-9f7f-a59854dace74" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Ieexec.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="a19b833c-0afe-4954-a68c-d15dbbbf2d8b" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Installutil.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="56d5bd81-219a-48af-acda-1a22f669e9a4" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Makecab.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="c06b5e6e-5a6b-472f-8940-ba2480c8bcd3" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">MpCmdRun.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="d99fec83-7176-401b-92c3-13ebd920101c" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Mshta.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f90d2dba-1b8d-4be0-a829-583d18d2ee87" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Msiexec.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="bd96ead4-83b4-469b-918e-da84401db4ca" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">OneDriveStandaloneUpdater.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="865b6fbf-5d77-47ad-b3b5-b1d7029a3d1a" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">PrintBrm.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="fa2776d5-8068-4c46-b967-0dff725f6788" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Regasm.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="d53f6f20-a204-46bd-a0e8-eae25b612d3a" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Regsvr32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="9d365ada-4603-4ba2-9e58-d06f2f542315" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Replace.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="9481c030-abce-4867-9d18-aef19ae8636e" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Rundll32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="7eaa6ad6-ed10-448c-9638-5b7adf446845" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Sc.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="b2e852f9-1123-4101-8d45-4debb70a7066" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Schtasks.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="e1bd0896-4074-4d4f-9964-97132ad446de" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Wmic.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="691fe0a8-b5cc-4b5d-ae30-022eb23e493d" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Wscript.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="ddf7c153-3960-49a4-a25a-4fa5c1f179ea" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Xwizard.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="280a354c-025b-4413-8d4a-3ac9f9c4aeab" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Excel.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="b99acd2e-0c5f-437e-be8a-2eb7d22e1085" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Powerpnt.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f986e504-b49c-4854-8470-f9adfd93768c" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Squirrel.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f5e1494c-d17c-4f81-a1ac-31445cf16fe5" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Winword.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="b616034b-d656-4275-a862-696312f68cda" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">Wsl.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="945703c3-cd8d-4541-8513-bef324e34386" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">powershell.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="790442b0-ab96-497b-afb4-709e51ecaaf7" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">nslookup.exe</Content>
          </IndicatorItem>
          <Indicator operator="AND" id="eea52dfc-027a-4302-abd0-7bbda2eda6b3">
            <IndicatorItem id="ea93875f-561f-4c75-a231-785f0ffe3b91" condition="is" preserve-case="false" negate="false">
              <Context document="processEvent" search="processEvent/process" type="event" />
              <Content type="string">Certutil.exe</Content>
            </IndicatorItem>
            <IndicatorItem id="bac5f044-2632-4a87-9057-fe85493a645a" condition="contains" preserve-case="false" negate="true">
              <Context document="processEvent" search="processEvent/parentProcessPath" type="event" />
              <Content type="string">\DigiCert\</Content>
            </IndicatorItem>
          </Indicator>
        </Indicator>
      </Indicator>
    </Indicator>
  </criteria>
  <parameters />
</OpenIOC>