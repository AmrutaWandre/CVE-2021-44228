<?xml version="1.0" encoding="utf-8"?>
<OpenIOC xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="5e3cd7b3-4844-4fe5-8d08-2f71cad53c5c" last-modified="2021-12-13T04:45:07Z" published-date="0001-01-01T00:00:00" xmlns="http://openioc.org/schemas/OpenIOC_1.1">
  <metadata>
    <short_description>SUSPICIOUS PROCESS LAUNCH FROM JAVA LINUX (METHODOLOGY)</short_description>
    <description>This IOC looks for suspicious commands from Java applications on Linux systems, and may provide an indicator of exploitation of a Remote Code Execution vulnerability such as CVE-2021-44228 (Apache Log4j 2), or the presence of a webshell on a Java-based web server. Note that /bin/sh launched by Java without any command line parameters may be indicative of an evasion technique in which commands are piped to /bin/sh. Investigate the source of activity and the processes launched to confirm maliciousness. This is associated with MITRE ATT&amp;CK (r) Tactic(s): Initial Access, Persistence, Defense Evasion and Technique(s): T1190, T1505.003, T1027.005.</description>
    <authored_by>FireEye</authored_by>
    <authored_date>2021-12-12T17:14:18Z</authored_date>
    <links>
      <link href="" rel="caveat">Methodology</link>
      <link href="" rel="caveat">Linux</link>
    </links>
  </metadata>
  <criteria>
    <Indicator operator="OR" id="fb025a8c-9dc3-4da8-9e98-561d50cd6e1d">
      <Indicator operator="AND" id="d884ee92-89d3-49e0-83d4-161ebe2bbf8e">
        <IndicatorItem id="b5277fb0-742c-4369-833a-5091344bb64e" condition="starts-with" preserve-case="false" negate="false">
          <Context document="processEvent" search="processEvent/parentProcess" type="event" />
          <Content type="string">java</Content>
        </IndicatorItem>
        <IndicatorItem id="da17bf25-fdc1-41fc-885a-68dc097b9f49" condition="is" preserve-case="false" negate="false">
          <Context document="processEvent" search="processEvent/eventType" type="event" />
          <Content type="string">start</Content>
        </IndicatorItem>
        <Indicator operator="OR" id="9dd2287a-d35d-4eeb-9132-beb0b5ff1197">
          <IndicatorItem id="4f9f6ef9-3d1e-4ef0-ba95-70a72e308243" condition="matches" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">^(ba|da|k)?sh\s+-c\s</Content>
          </IndicatorItem>
          <IndicatorItem id="35eb6489-2251-4c7b-894f-f233bc0bf986" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">cpan</Content>
          </IndicatorItem>
          <IndicatorItem id="6657a53c-6b73-4555-8a11-50e19e4a34ce" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">curl</Content>
          </IndicatorItem>
          <IndicatorItem id="e2278ef2-1d70-41f1-8a18-b5719ab0d3cf" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">easy_install</Content>
          </IndicatorItem>
          <IndicatorItem id="65971a9c-1337-4356-8c8e-811054267e36" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">finger</Content>
          </IndicatorItem>
          <IndicatorItem id="968a181e-126f-4703-addb-6ee409c6a3b6" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">ftp</Content>
          </IndicatorItem>
          <IndicatorItem id="4811af27-a09f-4b84-ac78-df3f9e83e985" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">gdb</Content>
          </IndicatorItem>
          <IndicatorItem id="25e94575-d91f-4bee-8bcc-f96ac37b6236" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">gimp</Content>
          </IndicatorItem>
          <IndicatorItem id="42818520-7875-4489-95e0-4a0772ae2fc3" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">irb</Content>
          </IndicatorItem>
          <IndicatorItem id="09a76af4-af8b-44be-b79f-354a8f2c8761" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">jjs</Content>
          </IndicatorItem>
          <IndicatorItem id="304b6adf-88bb-4ae2-922f-60653058a871" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">jrunscript</Content>
          </IndicatorItem>
          <IndicatorItem id="08d169d7-22ec-4073-82fb-84ad577371b9" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">lua</Content>
          </IndicatorItem>
          <IndicatorItem id="5bd76c99-f7b7-41b0-8507-6034f2c72ae6" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">lwp-download</Content>
          </IndicatorItem>
          <IndicatorItem id="4e7dc2b7-1703-4ed1-ad41-7dca5e237aab" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">nc</Content>
          </IndicatorItem>
          <IndicatorItem id="fa6884d2-d7a5-4369-b541-9b6cdea25fdb" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">nmap</Content>
          </IndicatorItem>
          <IndicatorItem id="a00066e5-9837-49f6-b8a4-427e254f7dfd" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">node</Content>
          </IndicatorItem>
          <IndicatorItem id="5ab08cd0-1a25-4038-9ecb-62aa25c02b10" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">openssl</Content>
          </IndicatorItem>
          <IndicatorItem id="4bb3730f-50c7-4660-a08e-2618271f2373" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">php</Content>
          </IndicatorItem>
          <IndicatorItem id="5b61be8b-a73c-4290-a77d-fc82dd0e1f71" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">pip</Content>
          </IndicatorItem>
          <IndicatorItem id="70dec528-7089-4e96-aab8-4822df07c9a0" condition="starts-with" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">python</Content>
          </IndicatorItem>
          <IndicatorItem id="e6fc4ac3-e049-451b-b2b6-1ecb937776bf" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">ruby</Content>
          </IndicatorItem>
          <IndicatorItem id="a3a0a50d-8594-4e9c-b4b6-1cce65c88ad7" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">rview</Content>
          </IndicatorItem>
          <IndicatorItem id="2ca47e05-d116-47ef-a04f-c0173da52afc" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">rvim</Content>
          </IndicatorItem>
          <IndicatorItem id="a60b1520-7485-4c69-81bf-42825ae4f5aa" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">scp</Content>
          </IndicatorItem>
          <IndicatorItem id="9e302b1b-b528-4f1e-8408-c9b4b8d6f456" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">sftp</Content>
          </IndicatorItem>
          <IndicatorItem id="f4a0b075-568a-486c-92cf-62f107798d93" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">smbclient</Content>
          </IndicatorItem>
          <IndicatorItem id="102729e0-03ea-4048-bb2a-864162d6dc23" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">socat</Content>
          </IndicatorItem>
          <IndicatorItem id="6f198189-4b36-4a89-8398-11ca95aaee67" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">ssh</Content>
          </IndicatorItem>
          <IndicatorItem id="73b30e2c-f0f0-4793-a220-237e53dbc808" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">tar</Content>
          </IndicatorItem>
          <IndicatorItem id="fd84d0d3-3f46-457c-8b7e-3e1b621b56f4" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">tftp</Content>
          </IndicatorItem>
          <IndicatorItem id="cb2e8552-7a20-4917-9f58-8371d60073bb" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">view</Content>
          </IndicatorItem>
          <IndicatorItem id="e3fda5c7-80cb-4ca8-bdfc-cf5b3be2aedc" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">vim</Content>
          </IndicatorItem>
          <IndicatorItem id="8da04dcb-fb63-431d-9921-5f35190610aa" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">vimdiff</Content>
          </IndicatorItem>
          <IndicatorItem id="b035f7bd-1c52-422e-af0e-8d7116f051ca" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">wget</Content>
          </IndicatorItem>
          <IndicatorItem id="f28e51df-96ab-41ba-a81c-b0574867fad1" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">whois</Content>
          </IndicatorItem>
          <IndicatorItem id="2a22a7d9-1cbc-40bd-bb9f-3e6ca93e7ee6" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">yum</Content>
          </IndicatorItem>
          <IndicatorItem id="a1442de1-daa8-4601-98af-7d396ab28e95" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">telnet</Content>
          </IndicatorItem>
          <IndicatorItem id="f122b420-d3ba-49a8-8421-39fc905a3ff8" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/process" type="event" />
            <Content type="string">echo</Content>
          </IndicatorItem>
          <IndicatorItem id="af12a5b1-9403-487b-a731-fbc22ab1e7c4" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">/bin/sh</Content>
          </IndicatorItem>
          <IndicatorItem id="318d20f0-6680-46a5-baf6-353383bf436e" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">/bin/bash</Content>
          </IndicatorItem>
          <IndicatorItem id="45a318eb-c219-40dd-ab06-397e643ea5be" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">/bin/dash</Content>
          </IndicatorItem>
          <IndicatorItem id="c6067f93-018c-49cb-9f78-011d7920c0c0" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">sh</Content>
          </IndicatorItem>
          <IndicatorItem id="d2f17218-a40a-45c8-a9ed-37f181bd42a6" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">bash</Content>
          </IndicatorItem>
          <IndicatorItem id="577cbd1c-81d1-42bd-a46e-38ace482553d" condition="is" preserve-case="false" negate="false">
            <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
            <Content type="string">dash</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
    </Indicator>
  </criteria>
  <parameters />
</OpenIOC>