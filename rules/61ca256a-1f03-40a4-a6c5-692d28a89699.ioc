<?xml version="1.0" encoding="utf-8"?>
<OpenIOC xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="61ca256a-1f03-40a4-a6c5-692d28a89699" last-modified="2021-12-14T00:23:23Z" published-date="0001-01-01T00:00:00" xmlns="http://openioc.org/schemas/OpenIOC_1.1">
  <metadata>
    <short_description>LOG4J CVE-2021-44228 POTENTIAL EXPLOITATION ATTEMPT (METHODOLOGY)</short_description>
    <description>CVE-2021-44228 or Log4Shell is a Remote Code Execution vulnerability in Log4J2 versions between 2.0 and 2.14.1, a popular Java logging library. If attackers can control the messages logged by Log4J, they can achieve code execution by sending specially crafted strings that leverage JNDI (Java Naming and Directory Interface) over multiple protocols including LDAP and RMI. This IOC looks for the presence of these strings written to files, which could be observed on a system being exploited (e.g., a web server log file). The IOC also looks for the presence of these strings in process command lines, HTTP headers, and HTTP request URLs, all of which would occur on a system from which the attack originated (e.g., an attacker attempting to move laterally).</description>
    <authored_by>FireEye</authored_by>
    <authored_date>2021-12-12T17:36:07Z</authored_date>
    <links>
      <link href="" rel="caveat">Methodology</link>
    </links>
  </metadata>
  <criteria>
    <Indicator operator="OR" id="b57a5665-45fd-4cc9-bc95-d3d00f12a2b6">
      <IndicatorItem id="b90a903c-3952-463a-98ac-b2673d003dea" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/httpHeader" type="event" />
        <Content type="string">(\$|%(25)*24)(\{|%(25)*7b)jndi(:|%(25)*3a)</Content>
      </IndicatorItem>
      <IndicatorItem id="cc42084b-b634-4f2e-a1bb-55be9d06c673" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/requestUrl" type="event" />
        <Content type="string">(\$|%(25)*24)(\{|%(25)*7b)jndi(:|%(25)*3a)</Content>
      </IndicatorItem>
      <IndicatorItem id="a3d83a90-e4f6-468b-b390-722c9a3a5fb0" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/userAgent" type="event" />
        <Content type="string">(\$|%(25)*24)(\{|%(25)*7b)jndi(:|%(25)*3a)</Content>
      </IndicatorItem>
      <IndicatorItem id="72169ce0-84e8-401e-aba6-b05097c16499" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/httpHeader" type="event" />
        <Content type="string">\${env:[a-z]+:-[jndi:]}</Content>
      </IndicatorItem>
      <IndicatorItem id="06a8b0bb-cbe8-4412-b12e-af8987587bb0" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/requestUrl" type="event" />
        <Content type="string">\${env:[a-z]+:-[jndi:]}</Content>
      </IndicatorItem>
      <IndicatorItem id="a0cbb126-dea0-4e70-96eb-f52db37981c0" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/userAgent" type="event" />
        <Content type="string">\${env:[a-z]+:-[jndi:]}</Content>
      </IndicatorItem>
      <IndicatorItem id="92cf5976-b27b-4b40-9a50-a78302e9bd59" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/httpHeader" type="event" />
        <Content type="string">\${(lower|upper):[jndi:]+}</Content>
      </IndicatorItem>
      <IndicatorItem id="f16f5a90-2126-435b-a68a-dd0d741068f8" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/userAgent" type="event" />
        <Content type="string">\${(lower|upper):[jndi:]+}</Content>
      </IndicatorItem>
      <IndicatorItem id="d401fc10-3a1f-460e-86b2-2cf5b3fb4764" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/requestUrl" type="event" />
        <Content type="string">\${(lower|upper):[jndi:]+}</Content>
      </IndicatorItem>
      <IndicatorItem id="a5099fd1-7983-4718-b4f9-aa006a43901f" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/httpHeader" type="event" />
        <Content type="string">\${(lower|upper)?::-[jndi]}</Content>
      </IndicatorItem>
      <IndicatorItem id="0b9c26ce-81b4-40c5-b3a0-7e47baec35a4" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/requestUrl" type="event" />
        <Content type="string">\${(lower|upper)?::-[jndi]}</Content>
      </IndicatorItem>
      <IndicatorItem id="1c6a3071-2820-4bbe-8fc7-9a9f0ee1064e" condition="matches" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/userAgent" type="event" />
        <Content type="string">\${(lower|upper)?::-[jndi]}</Content>
      </IndicatorItem>
      <IndicatorItem id="2b026df2-0d33-43af-b287-5c1754ac05f3" condition="contains" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/httpHeader" type="event" />
        <Content type="string">${base64:JHtqbmRp</Content>
      </IndicatorItem>
      <IndicatorItem id="9d5ff9a8-a4ab-4e93-89a4-d270283efb7b" condition="contains" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/requestUrl" type="event" />
        <Content type="string">${base64:JHtqbmRp</Content>
      </IndicatorItem>
      <IndicatorItem id="f9b73739-f2d6-4fb4-b653-cec7c54fb522" condition="contains" preserve-case="false" negate="false">
        <Context document="urlMonitorEvent" search="urlMonitorEvent/userAgent" type="event" />
        <Content type="string">${base64:JHtqbmRp</Content>
      </IndicatorItem>
      <IndicatorItem id="9256e792-8f4f-490f-8051-da6c414df597" condition="matches" preserve-case="false" negate="false">
        <Context document="fileWriteEvent" search="fileWriteEvent/textAtLowestOffset" type="event" />
        <Content type="string">(\$|%(25)*24)(\{|%(25)*7b)jndi(:|%(25)*3a)</Content>
      </IndicatorItem>
      <IndicatorItem id="122ffe67-613c-4849-b53c-b0954ab44d3e" condition="matches" preserve-case="false" negate="false">
        <Context document="fileWriteEvent" search="fileWriteEvent/textAtLowestOffset" type="event" />
        <Content type="string">\${env:[a-z]+:-[jndi:]}</Content>
      </IndicatorItem>
      <IndicatorItem id="ca435a23-cd96-4d15-a019-64e57bc3400d" condition="matches" preserve-case="false" negate="false">
        <Context document="fileWriteEvent" search="fileWriteEvent/textAtLowestOffset" type="event" />
        <Content type="string">\${(lower|upper):[jndi:]+}</Content>
      </IndicatorItem>
      <IndicatorItem id="c2d52aec-d165-43ad-a01b-93150b278184" condition="matches" preserve-case="false" negate="false">
        <Context document="fileWriteEvent" search="fileWriteEvent/textAtLowestOffset" type="event" />
        <Content type="string">\${(lower|upper)?::-[jndi]}</Content>
      </IndicatorItem>
      <IndicatorItem id="984b06ba-66c7-4970-b96a-eb5315b7adde" condition="contains" preserve-case="false" negate="false">
        <Context document="fileWriteEvent" search="fileWriteEvent/textAtLowestOffset" type="event" />
        <Content type="string">${base64:JHtqbmRp</Content>
      </IndicatorItem>
      <IndicatorItem id="1bce8767-4ba9-4eea-b243-e44b01a54c41" condition="matches" preserve-case="false" negate="false">
        <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
        <Content type="string">(\$|%(25)*24)(\{|%(25)*7b)jndi(:|%(25)*3a)</Content>
      </IndicatorItem>
      <IndicatorItem id="4b9f6ca8-13a6-4e5e-adb1-fb6fe9c3a2ae" condition="matches" preserve-case="false" negate="false">
        <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
        <Content type="string">\${env:[a-z]+:-[jndi:]}</Content>
      </IndicatorItem>
      <IndicatorItem id="a5ec739e-0f39-4a25-84f6-d19cb56cc269" condition="matches" preserve-case="false" negate="false">
        <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
        <Content type="string">\${(lower|upper):[jndi:]+}</Content>
      </IndicatorItem>
      <IndicatorItem id="7b86021f-78ad-4ce1-8497-a34b0eaf43a1" condition="matches" preserve-case="false" negate="false">
        <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
        <Content type="string">\${(lower|upper)?::-[jndi]}</Content>
      </IndicatorItem>
      <IndicatorItem id="af1ed956-7ad2-4c22-ab70-069284dc298f" condition="contains" preserve-case="false" negate="false">
        <Context document="processEvent" search="processEvent/processCmdLine" type="event" />
        <Content type="string">${base64:JHtqbmRp</Content>
      </IndicatorItem>
    </Indicator>
  </criteria>
  <parameters />
</OpenIOC>